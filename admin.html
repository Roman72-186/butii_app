<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Beauty Studio ‚Äî –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</title>
    <link rel="stylesheet" href="css/admin.css">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üíÖ</text></svg>">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>

    <!-- ========== –≠–ö–†–ê–ù –í–•–û–î–ê ========== -->
    <div id="loginScreen" class="login-screen">
        <div class="login-card">
            <div class="login-logo">üíÖ</div>
            <h1>Beauty Studio</h1>
            <p class="login-subtitle">–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</p>

            <form id="loginForm" onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label for="loginPhone">–¢–µ–ª–µ—Ñ–æ–Ω</label>
                    <input type="tel" id="loginPhone" placeholder="+7 (___) ___-__-__" required>
                </div>
                <div class="form-group">
                    <label for="loginPassword">–ü–∞—Ä–æ–ª—å</label>
                    <input type="password" id="loginPassword" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å" required>
                </div>
                <div id="loginError" class="error-message" style="display:none;"></div>
                <button type="submit" class="btn-primary" id="loginBtn">–í–æ–π—Ç–∏</button>
            </form>
        </div>
    </div>

    <!-- ========== –ü–ê–ù–ï–õ–¨ –£–ü–†–ê–í–õ–ï–ù–ò–Ø ========== -->
    <div id="dashboard" class="dashboard" style="display:none;">

        <!-- –°–∞–π–¥–±–∞—Ä -->
        <aside id="sidebar" class="sidebar">
            <div class="sidebar-header">
                <span class="sidebar-logo">üíÖ</span>
                <span class="sidebar-title">Beauty Studio</span>
            </div>

            <div class="sidebar-user">
                <div class="sidebar-user-name" id="userName"></div>
                <div class="sidebar-user-role" id="userRole"></div>
            </div>

            <nav id="sidebarNav" class="sidebar-nav"></nav>

            <button class="sidebar-logout" onclick="handleLogout()">–í—ã–π—Ç–∏</button>
        </aside>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <main id="mainContent" class="main-content">

            <!-- ===== –ó–ê–ü–ò–°–ò (–æ–±—â–∏–π –≤–∏–¥) ===== -->
            <section id="viewBookings" class="view" style="display:none;">
                <div class="view-header">
                    <h2>–ó–∞–ø–∏—Å–∏</h2>
                    <div class="view-header-actions">
                        <input type="date" id="bookingsDateFilter" onchange="loadBookings()">
                        <select id="bookingsStatusFilter" onchange="loadBookings()">
                            <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                            <option value="confirmed">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã–µ</option>
                            <option value="pending">–û–∂–∏–¥–∞—é—â–∏–µ</option>
                            <option value="cancelled">–û—Ç–º–µ–Ω—ë–Ω–Ω—ã–µ</option>
                            <option value="completed">–ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ</option>
                        </select>
                    </div>
                </div>
                <div id="bookingsTable" class="data-table-wrap"></div>
            </section>

            <!-- ===== –ú–û–Å –†–ê–°–ü–ò–°–ê–ù–ò–ï (—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç) ===== -->
            <section id="viewSchedule" class="view" style="display:none;">
                <div class="view-header">
                    <h2>–ú–æ—ë —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ</h2>
                </div>
                <div class="schedule-grid" id="scheduleGrid"></div>

                <div class="view-header" style="margin-top:2rem;">
                    <h2>–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º—è</h2>
                </div>
                <div class="block-slot-form">
                    <input type="date" id="blockDate" min="">
                    <input type="time" id="blockTime" step="1800" value="09:00">
                    <input type="text" id="blockReason" placeholder="–ü—Ä–∏—á–∏–Ω–∞ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)">
                    <button class="btn-primary btn-sm" onclick="handleBlockSlot()">–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å</button>
                </div>
                <div id="blockedSlotsList" class="blocked-list"></div>
            </section>

            <!-- ===== –°–ü–ï–¶–ò–ê–õ–ò–°–¢–´ (–∞–¥–º–∏–Ω) ===== -->
            <section id="viewSpecialists" class="view" style="display:none;">
                <div class="view-header">
                    <h2>–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—ã</h2>
                    <button class="btn-primary btn-sm" onclick="showAddSpecialistModal()">+ –î–æ–±–∞–≤–∏—Ç—å</button>
                </div>
                <div id="specialistsTable" class="data-table-wrap"></div>
            </section>

            <!-- ===== –ö–õ–ò–ï–ù–¢–´ (–∞–¥–º–∏–Ω) ===== -->
            <section id="viewClients" class="view" style="display:none;">
                <div class="view-header">
                    <h2>–ö–ª–∏–µ–Ω—Ç—ã</h2>
                </div>
                <div id="clientsTable" class="data-table-wrap"></div>
            </section>

            <!-- ===== –£–°–õ–£–ì–ò (–∞–¥–º–∏–Ω) ===== -->
            <section id="viewServices" class="view" style="display:none;">
                <div class="view-header">
                    <h2>–£—Å–ª—É–≥–∏</h2>
                    <button class="btn-primary btn-sm" onclick="showAddServiceModal()">+ –î–æ–±–∞–≤–∏—Ç—å</button>
                </div>
                <div id="servicesTable" class="data-table-wrap"></div>
            </section>

        </main>
    </div>

    <!-- ========== –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û ========== -->
    <div id="modal" class="modal-overlay" style="display:none;" onclick="closeModal(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h3 id="modalTitle"></h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div id="modalBody" class="modal-body"></div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/supabase-config.js"></script>
    <script src="js/admin.js"></script>
</body>
</html>
